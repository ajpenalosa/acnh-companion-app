<?php

require_once 'config.php';

if (isset($_SESSION['access_token']) && $_SESSION['access_token']) {
    $_SESSION['logged_in'] = 1;
    $client->setAccessToken($_SESSION['access_token']);

    // get profile info
    $google_oauth = new Google_Service_Oauth2($client);
    $google_account_info = $google_oauth->userinfo->get();
    $picture =  $google_account_info->picture;
    $first_name =  $google_account_info->givenName;

}

$page = (isset($_GET['page'])?htmlentities($_GET['page']):'');

// LOOKING HERE! https://www.codepunker.com/blog/3-solutions-for-multidimensional-array-sorting-by-child-keys-or-values-in-PHP

// Include PHP functions
// include './helpers/functions.inc';

?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no' />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel='shortcut icon' href='./favicon.ico' type='image/x-icon'>
    <title>Animal Crossing: New Horizons - Helpful Tools</title>
    <link href="./assets/css/style.css" rel="stylesheet">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
</head>
<body>
    <svg style="position: absolute; width: 0; height: 0; overflow: hidden" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <defs>
            <symbol id="bug" viewBox="0 0 512 512">
                <title>bug</title>
                <path d="M511.988 288.9c-.478 17.43-15.217 31.1-32.653 31.1H424v16c0 21.864-4.882 42.584-13.6 61.145l60.228 60.228c12.496 12.497 12.496 32.758 0 45.255-12.498 12.497-32.759 12.496-45.256 0l-54.736-54.736C345.886 467.965 314.351 480 280 480V236c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v244c-34.351 0-65.886-12.035-90.636-32.108l-54.736 54.736c-12.498 12.497-32.759 12.496-45.256 0-12.496-12.497-12.496-32.758 0-45.255l60.228-60.228C92.882 378.584 88 357.864 88 336v-16H32.666C15.23 320 .491 306.33.013 288.9-.484 270.816 14.028 256 32 256h56v-58.745l-46.628-46.628c-12.496-12.497-12.496-32.758 0-45.255 12.498-12.497 32.758-12.497 45.256 0L141.255 160h229.489l54.627-54.627c12.498-12.497 32.758-12.497 45.256 0 12.496 12.497 12.496 32.758 0 45.255L424 197.255V256h56c17.972 0 32.484 14.816 31.988 32.9zM257 0c-61.856 0-112 50.144-112 112h224C369 50.144 318.856 0 257 0z"/>
            </symbol>
            <symbol id="caret-down" viewBox="0 0 512 512">
                <title>caret-down</title>
                <path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"/>
            </symbol>
            <symbol id="check" viewBox="0 0 512 512">
                <title>check</title>
                <path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/>
            </symbol>
            <symbol id="cog" viewBox="0 0 512 512">
                <title>cog</title>
                <path d="M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"/>
            </symbol>
            <symbol id="diy-card" viewBox="0 0 380 512">
                <title>diy-card</title>
                <path d="M276.2,266.6c3.4,21.6-2.7,38.7-7.7,45.9c-5,7.2-14.5,5-21.7,0c-7.2-5,5-25.5,3.3-34.4c-1.7-8.9-8.3-12.3-7.7-20.9 C243.5,239.7,273.5,249.3,276.2,266.6z M380,49.3v413.5c0,27.2-22.1,49.3-49.3,49.3H49.3C22.1,512,0,489.9,0,462.7V49.3 C0,22.1,22.1,0,49.3,0h281.5C357.9,0,380,22.1,380,49.3z M288.5,231.3c-21.7-23-61.2-22.9-111.2-22.8c-28.9,0-85.1,15-94.5,35.6 c-11.1,24.2-17.2,87.3,7.8,119.9c21.9,28.5,80.6,80.3,95.8,80.3c26.5,0,85.4-57,103.2-82.3C299.3,348.3,315.6,260.1,288.5,231.3z M304.1,142.3c-6.7-20.6-20.6-33.4-41.2-42.8c-11.5-5.3-67.8-6.7-67.8-6.7c-1.7-43.9-26.4-41-32.3-37.8c-7.6,4.1-11.2,12.2-2.9,24.5 c8.3,12.2,6.2,16.5,6.2,16.5c-57.3-10-90.1,31.3-98.9,54.1c-17.2,44.5,5.9,73.1,5.9,73.1c11.1,6.1,22.5-27.2,117.8-28.9 c37.4-0.7,94.1,15.4,105.4,14.2C312.4,206.8,309.6,159.4,304.1,142.3z M247.2,326.4c-5.1,0.3-14.4,5.1-12.7,12.9 c1.7,7.8,4.1,11.5,10.6,14.1c7.1,2.7,12.2-3.5,15.3-7.9C263.4,340.9,259.8,325.6,247.2,326.4z"/>
            </symbol>
            <symbol id="everything" viewBox="0 0 512 512">
                <title>everything</title>
                <path d="M146,30.4v85.3c0,16.8-13.6,30.4-30.4,30.4H30.4C13.6,146,0,132.4,0,115.6V30.4C0,13.6,13.6,0,30.4,0h85.3 C132.4,0,146,13.6,146,30.4z M298.6,0h-85.3C196.6,0,183,13.6,183,30.4v85.3c0,16.8,13.6,30.4,30.4,30.4h85.3 c16.8,0,30.4-13.6,30.4-30.4V30.4C329,13.6,315.4,0,298.6,0z M481.6,0h-85.3C379.6,0,366,13.6,366,30.4v85.3 c0,16.8,13.6,30.4,30.4,30.4h85.3c16.8,0,30.4-13.6,30.4-30.4V30.4C512,13.6,498.4,0,481.6,0z M115.6,183H30.4 C13.6,183,0,196.6,0,213.4v85.3C0,315.4,13.6,329,30.4,329h85.3c16.8,0,30.4-13.6,30.4-30.4v-85.3C146,196.6,132.4,183,115.6,183z M298.6,183h-85.3c-16.8,0-30.4,13.6-30.4,30.4v85.3c0,16.8,13.6,30.4,30.4,30.4h85.3c16.8,0,30.4-13.6,30.4-30.4v-85.3 C329,196.6,315.4,183,298.6,183z M481.6,183h-85.3c-16.8,0-30.4,13.6-30.4,30.4v85.3c0,16.8,13.6,30.4,30.4,30.4h85.3 c16.8,0,30.4-13.6,30.4-30.4v-85.3C512,196.6,498.4,183,481.6,183z M115.6,366H30.4C13.6,366,0,379.6,0,396.4v85.3 C0,498.4,13.6,512,30.4,512h85.3c16.8,0,30.4-13.6,30.4-30.4v-85.3C146,379.6,132.4,366,115.6,366z M298.6,366h-85.3 c-16.8,0-30.4,13.6-30.4,30.4v85.3c0,16.8,13.6,30.4,30.4,30.4h85.3c16.8,0,30.4-13.6,30.4-30.4v-85.3 C329,379.6,315.4,366,298.6,366z M481.6,366h-85.3c-16.8,0-30.4,13.6-30.4,30.4v85.3c0,16.8,13.6,30.4,30.4,30.4h85.3 c16.8,0,30.4-13.6,30.4-30.4v-85.3C512,379.6,498.4,366,481.6,366z"/>
            </symbol>
            <symbol id="fire" viewBox="0 0 448 512">
                <title>fire</title>
                <path d="M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0 69.74 91.17 0 209.96 0 281.6 0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416 154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75 6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97 27.35 52.19 15.81 118.97-33.43 153.42z"/>
            </symbol>
            <symbol id="fish" viewBox="0 0 576 512">
                <title>fish</title>
                <path d="M327.1 96c-89.97 0-168.54 54.77-212.27 101.63L27.5 131.58c-12.13-9.18-30.24.6-27.14 14.66L24.54 256 .35 365.77c-3.1 14.06 15.01 23.83 27.14 14.66l87.33-66.05C158.55 361.23 237.13 416 327.1 416 464.56 416 576 288 576 256S464.56 96 327.1 96zm87.43 184c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24 13.26 0 24 10.74 24 24 0 13.25-10.75 24-24 24z"/>
            </symbol>
            <symbol id="hammer" viewBox="0 0 576 512">
                <title>hammer</title>
                <path d="M571.31 193.94l-22.63-22.63c-6.25-6.25-16.38-6.25-22.63 0l-11.31 11.31-28.9-28.9c5.63-21.31.36-44.9-16.35-61.61l-45.25-45.25c-62.48-62.48-163.79-62.48-226.28 0l90.51 45.25v18.75c0 16.97 6.74 33.25 18.75 45.25l49.14 49.14c16.71 16.71 40.3 21.98 61.61 16.35l28.9 28.9-11.31 11.31c-6.25 6.25-6.25 16.38 0 22.63l22.63 22.63c6.25 6.25 16.38 6.25 22.63 0l90.51-90.51c6.23-6.24 6.23-16.37-.02-22.62zm-286.72-15.2c-3.7-3.7-6.84-7.79-9.85-11.95L19.64 404.96c-25.57 23.88-26.26 64.19-1.53 88.93s65.05 24.05 88.93-1.53l238.13-255.07c-3.96-2.91-7.9-5.87-11.44-9.41l-49.14-49.14z"/>
            </symbol>
            <symbol id="list" viewBox="0 0 512 512">
                <title>list</title>
                <path d="M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"/>
            </symbol>
            <symbol id="search" viewBox="0 0 512 512">
                <title>search</title>
                <path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/>
            </symbol>
            <symbol id="sign-in-alt" viewBox="0 0 512 512">
                <title>sign-in-alt</title>
                <path d="M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z"/>
            </symbol>
            <symbol id="sign-out-alt" viewBox="0 0 512 512">
                <title>sign-out-alt</title>
                <path d="M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"/>
            </symbol>
            <symbol id="sort-down" viewBox="0 0 320 512">
                <title>sort-down</title>
                <path d="M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41z"/>
            </symbol>
            <symbol id="star" viewBox="0 0 576 512">
                <title>star</title>
                <path d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/>
            </symbol>
        </defs>
    </svg>
    
    <header>
        <? if (isset($_SESSION['logged_in']) && $_SESSION['logged_in']) { ?>
            <div class="profile-info">
                <button class="btn-profile-settings">
                    <img src="<?=$picture?>" class="profile-picture" />
                    <?= $first_name ?>
                    <svg class="icon icon-caret-down"><use xlink:href="#caret-down"></use></svg>
                </button>
                <div class="profile-options">
                    <a class="btn-logout" href="/logout.php">
                        <svg class="icon icon-sign-out-alt"><use xlink:href="#sign-out-alt"></use></svg> Logout
                    </a>
                </div>
            </div>
        <? } else { ?>
            <a href="/login.php" class="btn-login">
                <svg class="icon icon-sign-in-alt"><use xlink:href="#sign-in-alt"></use></svg>Login
            </a>
        <? } ?>
    </header>
    
    <nav>
        <a href="/?page=diy"><svg class="icon icon-hammer"><use xlink:href="#hammer"></use></svg></a>
        <a href="/?page=fish"><svg class="icon icon-fish"><use xlink:href="#fish"></use></svg></a>
        <a href="/?page=bugs"><svg class="icon icon-bug"><use xlink:href="#bug"></use></svg></a>
        <a href="/?page=daily-checklist"><svg class="icon icon-list"><use xlink:href="#list"></use></svg></a>
        <a href="/?page=settings"><svg class="icon icon-cog"><use xlink:href="#cog"></use></svg></a>
    </nav>

    <div class="main-content">
        <? include './pages/'. (empty($page) ? 'diy' : $page ) . '.inc'; ?>
    </div>

    <script src="./assets/js/jquery-3.5.1.min.js"></script>
    <script src="./assets/js/javascript.js"></script>
</body>
</html>